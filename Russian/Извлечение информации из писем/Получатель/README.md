### Описание
Правило ищет получателя письма.

### Примеры найденных сущностей
* 24.05.2018 № 17-102-4545 **ПАО «Силовые машины» Начальнику УИП Иванову Е.Ю.**
* 12.07.2019 № ЗТ/ИУ1450-89 **Техническому директору АО «ВПО «ЗАЭС» В.Ф. Владимирову**

### Инструкция
* Создать новый проект в платформе [PolyAnalyst](https://www.megaputer.ru/produkti/)
* Загрузить в проект файл [**Данные_Получатель.txt**](Данные_Получатель.txt)
* Добавить узел **Извлечение сущностей**, в настройках узла:
	* отключить все стандартные сущности, кроме сущностей **Companies** (Компании), **Organizations** (Организации) и **People** (Люди)
	* выполнить узел
* Добавить еще один узел **Извлечение сущностей**, в настройках узла:
	 * отключить стандартные сущности
	 * создать новую пользовательскую сущность
	 * открыть **Редактор правил** новой сущности и скопировать в него правило [**Получатель.txt**](Получатель.txt):
	 ```
	rule: имя_получателя
	{
		query: {follow({optional(копия)}:копия, 
						// CaseAccusative на случай ошибок индексирования, напр., "Класину Д. А."
						position(200, {entity(People)}:имя & lemma(CaseDative|CaseAccusative)))}:м

		result: Результат = $м
			attribute: Получатель = toentity(People, $имя)
			attribute: Должность = toentity(People, $имя, field:=Attribute)
			attribute: Компания = toentity(Companies, toentity(People, $имя, field:=Attribute))
			attribute: Тип = if($копия, "Копия", "Оригинал")
			
		rule: атрибуты_получателя
		{
			query: {follow({optional(копия)}:копия_письма,
								fnear(repeat(1, 10, {orn(начальник, генеральный, технический, директор, заместитель,
											
											phrase(и, ".", о, "."), "исполняющий обязанности",
										
											phrase(по, repeat(1, 10, lemma(CaseDative|CaseGenitive) or "и" or char(punct))),
							
											lemma(CaseGenitive|CaseNominative), number(), "и", "-")}:должность
											
											or {entity(Companies|Organizations)}:компания),
								$имя))}:м_атр
			
			result: Результат = $м_атр
				attribute: Получатель = toentity(People, $имя)
				attribute: Должность = $должность
				attribute: Компания = toentity(Companies, $компания)
				attribute: Тип = if($копия_письма, "Копия", "Оригинал")
		}
	}

	```
	 * выполнить узел

### Структура сущности
* **Результат** - общий вывод сущности
* **Получатель** - получатель письма
* **Должность** - должность получателя
* **Компания** - компания получателя
* **Тип** - тип письма

### Отчет узла
Отчет узла **Извлечение сущностей** выглядит следующим образом:

| Результат | Получатель | Должность | Компания | Тип |
| ------ | ------ | ------ | ------ | ------ |
| Заместителю начальника управления инженерной поддержки ПАО "Силовые машины" П.П. Петрову | П.П. Петров | Заместитель начальника управления инженерной поддержки | ПАО «Силовые машины» | Оригинал | 

В тексте подсвечиваются следующие фрагменты:
> № 050-0158 от 14.12.2018 г.
>
> **Заместителю начальника**
> **управления инженерной поддержки**
> **ПАО «Силовые машины»**
> **П.П. Петрову**
